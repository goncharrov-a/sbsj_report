{"uid":"e32671e940a3267f","name":"Периодичность — невалидное случайное значение → 400","fullName":"tests.api.test_cached_user_validation.TestCachedUserValidation#test_payment_periodicity_invalid_random","historyId":"f7d150bcfadfd1c7ed3cf119d16c3de1","time":{"start":1763155610300,"stop":1763155612064,"duration":1764},"status":"failed","statusMessage":"AssertionError: Ожидали 400, получили 201: {\"code\": 200, \"data\": {\"id\": \"32c7a224-9786-4d8f-92ae-1d48f1eefb88\", \"calculation\": 240.0, \"debt\": 300000.0, \"policyStartDate\": \"2025-11-16T00:26:50.401141143\", \"birthDate\": \"2000-01-01T00:00:00.000\", \"gender\": \"M\", \"isPartnerLink\": null, \"paymentPeriodicity\": \"MONTHLY\", \"extremalSport\": true, \"term\": 10}, \"errors\": null, \"exception\": null}\nassert 201 == 400\n +  where 201 = <Response [201]>.status_code","statusTrace":"self = <tests.api.test_cached_user_validation.TestCachedUserValidation object at 0x7f0c45a20770>\napi = <src.api.safety_pillow_api.SafetyPillowApi object at 0x7f0c4547ff80>\n\n    @allure.story(\"Негатив\")\n    @allure.title(\"Периодичность — невалидное случайное значение → 400\")\n    def test_payment_periodicity_invalid_random(self, api: SafetyPillowApi):\n        value = _random_payment_periodicity_invalid()\n        payload = BASE_VALID.copy()\n        payload[\"paymentPeriodicity\"] = value\n        attach_pretty_json({\"paymentPeriodicity\": value}, \"Параметры\")\n        resp = api.create_cached_user(payload)\n>       assert resp.status_code == 400, f\"Ожидали 400, получили {resp.status_code}: {_snippet(resp)}\"\nE       AssertionError: Ожидали 400, получили 201: {\"code\": 200, \"data\": {\"id\": \"32c7a224-9786-4d8f-92ae-1d48f1eefb88\", \"calculation\": 240.0, \"debt\": 300000.0, \"policyStartDate\": \"2025-11-16T00:26:50.401141143\", \"birthDate\": \"2000-01-01T00:00:00.000\", \"gender\": \"M\", \"isPartnerLink\": null, \"paymentPeriodicity\": \"MONTHLY\", \"extremalSport\": true, \"term\": 10}, \"errors\": null, \"exception\": null}\nE       assert 201 == 400\nE        +  where 201 = <Response [201]>.status_code\n\ntests/api/test_cached_user_validation.py:381: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1763155597234,"stop":1763155597281,"duration":47},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"env","time":{"start":1763155597282,"stop":1763155597282,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api","time":{"start":1763155597282,"stop":1763155597282,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_seed_for_repro","time":{"start":1763155597282,"stop":1763155597282,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"http","time":{"start":1763155597282,"stop":1763155597282,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: Ожидали 400, получили 201: {\"code\": 200, \"data\": {\"id\": \"32c7a224-9786-4d8f-92ae-1d48f1eefb88\", \"calculation\": 240.0, \"debt\": 300000.0, \"policyStartDate\": \"2025-11-16T00:26:50.401141143\", \"birthDate\": \"2000-01-01T00:00:00.000\", \"gender\": \"M\", \"isPartnerLink\": null, \"paymentPeriodicity\": \"MONTHLY\", \"extremalSport\": true, \"term\": 10}, \"errors\": null, \"exception\": null}\nassert 201 == 400\n +  where 201 = <Response [201]>.status_code","statusTrace":"self = <tests.api.test_cached_user_validation.TestCachedUserValidation object at 0x7f0c45a20770>\napi = <src.api.safety_pillow_api.SafetyPillowApi object at 0x7f0c4547ff80>\n\n    @allure.story(\"Негатив\")\n    @allure.title(\"Периодичность — невалидное случайное значение → 400\")\n    def test_payment_periodicity_invalid_random(self, api: SafetyPillowApi):\n        value = _random_payment_periodicity_invalid()\n        payload = BASE_VALID.copy()\n        payload[\"paymentPeriodicity\"] = value\n        attach_pretty_json({\"paymentPeriodicity\": value}, \"Параметры\")\n        resp = api.create_cached_user(payload)\n>       assert resp.status_code == 400, f\"Ожидали 400, получили {resp.status_code}: {_snippet(resp)}\"\nE       AssertionError: Ожидали 400, получили 201: {\"code\": 200, \"data\": {\"id\": \"32c7a224-9786-4d8f-92ae-1d48f1eefb88\", \"calculation\": 240.0, \"debt\": 300000.0, \"policyStartDate\": \"2025-11-16T00:26:50.401141143\", \"birthDate\": \"2000-01-01T00:00:00.000\", \"gender\": \"M\", \"isPartnerLink\": null, \"paymentPeriodicity\": \"MONTHLY\", \"extremalSport\": true, \"term\": 10}, \"errors\": null, \"exception\": null}\nE       assert 201 == 400\nE        +  where 201 = <Response [201]>.status_code\n\ntests/api/test_cached_user_validation.py:381: AssertionError","steps":[],"attachments":[{"uid":"c30da392e24a6d8a","name":"Параметры","source":"c30da392e24a6d8a.json","type":"application/json","size":29},{"uid":"c3563141240074c2","name":"cached/user/index - Request","source":"c3563141240074c2.json","type":"application/json","size":217},{"uid":"bfdd6bbeb8bfbc05","name":"cached/user/index - Response","source":"bfdd6bbeb8bfbc05.json","type":"application/json","size":575},{"uid":"bee8f93fe0b6d2e","name":"cached/user/index - Curl","source":"bee8f93fe0b6d2e.txt","type":"text/plain","size":348}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":4,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"feature","value":"POST /podushka-bezopasnosti/api/v1/cached/user/index — валидация"},{"name":"story","value":"Негатив"},{"name":"epic","value":"Подушка безопасности"},{"name":"tag","value":"api"},{"name":"parentSuite","value":"tests.api"},{"name":"suite","value":"test_cached_user_validation"},{"name":"subSuite","value":"TestCachedUserValidation"},{"name":"host","value":"runnervmg1sw1"},{"name":"thread","value":"1999-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.api.test_cached_user_validation"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":["api"]},"source":"e32671e940a3267f.json","parameterValues":[]}